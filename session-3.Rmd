---
title: "Session 3 Tasks"
author: "Andreas Angourakis"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
```


Combining the vectors into a data frame

```{r}
stone_tools_data <- data.frame(
  inventory_number = c("LN15", "LN17", "LN18", "LN21", "LN23", "LN24"),
  blength = c(18, 14, 21, 14, 17, 16),
  breadth = c(9, 7, 10, 7, 8, 8),
  thickness = c(3, 2, 3, 3, 3, 2),
  material_type = c("chert", "chert", "obsidian", "chert", "obsidian", "obsidian"),
  material_provenance = c("local", "local", "local", "non-local", "local", "non-local")
)
```

Check that the data and data types are coherent with the specifications. Display the data frame:

```{r}
knitr::kable(stone_tools_data)
```

Save it as a CSV file (stored in a “data” subdirectory) 

```{r}
write.csv(stone_tools_data, "data/stone_tools_data.csv")
```

Load it back as a new R object (e.g. “stone_tools_data2”). 

```{r}
stone_tools_data2 <- read.csv("data/stone_tools_data.csv")[, -1]
```

Create a plot showing the counts of objects made of chert and obsidian. Save it as a PNG file in “plots” subdirectory.

```{r}
stone_tools_data_table_type <- table(stone_tools_data$material_type)

png("plots/session3_barplot_material_type.png")

barplot(stone_tools_data_table_type, 
        main = "Bar Plot of count of artifacts by material type", 
        xlab = "Material type")

dev.off()
```

Create a new variable (“type_and_provenance”) that combines type and provenance 

```{r}
stone_tools_data$type_and_provenance <- paste(stone_tools_data$material_type, stone_tools_data$material_provenance, sep = " and ") 
```

Create a plot showing the counts in each category. Save it as a PNG file in “plots” subdirectory.

```{r}
stone_tools_data_table_type_and_provenance <- table(stone_tools_data$type_and_provenance)

png("plots/session3_barplot_material_type_and_provenance.png", width = 700)

barplot(stone_tools_data_table_type_and_provenance, 
        main = "Bar Plot of count of artifacts by material type and provenance", 
        xlab = "Material type and provenance")

dev.off()
```

```{r}
png("plots/session3_barplot_material_type_and_provenance_ggplot.png", width = 700)

ggplot(stone_tools_data, aes(x = type_and_provenance)) + 
  geom_bar() + 
  labs(title = "Bar plot of Blade Shape", x = "Blade Shape categories")

dev.off()
```

